<!DOCTYPE glassfish-web-app PUBLIC "-//GlassFish.org//DTD
GlassFish Application Server 3.1 Servlet 3.0//EN"
        "http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd">
<glassfish-web-app>
    <context-root>/</context-root>

    <security-role-mapping>
        <role-name>ROLE_ADMIN</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>ROLE_EMPLOYEE</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>ROLE_CUSTOMER</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>

    <!-- AccountEndpoint -->
    <security-role-mapping>
        <role-name>addAccount</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>editAccount</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>editOwnAccount</role-name>
        <group-name>ROLE_ADMIN</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>grantAdminAccessLevel</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>grantEmployeeAccessLevel</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>grantCustomerAccessLevel</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>revokeAccessLevel</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getAllAccounts</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getAccountDetails</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getOwnAccountDetails</role-name>
        <group-name>ROLE_ADMIN</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>changeOwnPassword</role-name>
        <group-name>ROLE_ADMIN</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>changeOwnEmail</role-name>
        <group-name>ROLE_ADMIN</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>changePassword</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>lockAccount</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>unlockAccount</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getAccountsFilteredByPhraseInFullName</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>sendEmailChangeLink</role-name>
        <group-name>ROLE_ADMIN</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>sendUsersEmailChangeLink</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getAdminReport</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>sendVerificationLink</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>

    <!-- AuthenticationEndpoint -->
    <security-role-mapping>
        <role-name>logout</role-name>
        <group-name>ROLE_ADMIN</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>

    <!-- SendingEmailEndpoint -->
    <security-role-mapping>
        <role-name>activityChangedNotification</role-name>
        <group-name>ROLE_ADMIN</group-name>
    </security-role-mapping>

    <!-- ChangeRoleEndpoint -->
    <security-role-mapping>
        <role-name>changeRole</role-name>
        <group-name>ROLE_ADMIN</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>

    <!-- MOR -->

    <!-- AlleyDifficultyLevelEndpoint -->
    <security-role-mapping>
        <role-name>getAllAlleyDifficultyLevels</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>

    <!-- AlleyEndpoint -->
    <security-role-mapping>
        <role-name>getAllActiveAlleys</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getAlleyDetails</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>addAlley</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>removeAlley</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>editAlley</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>

    <!-- ReservationEndpoint -->
    <security-role-mapping>
        <role-name>getReservation</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getOwnReservation</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>updateReservation</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>updateOwnReservation</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>makeReservation</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>cancelReservation</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>cancelOwnReservation</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getAllReservations</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getAllOwnReservations</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getConflictReservationsByWeaponModel</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getConflictReservationsByWeapon</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>

    <!-- WeaponEndpoint -->
    <security-role-mapping>
        <role-name>getAllActiveWeapons</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getAllActiveWeaponsByModelName</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>removeWeapon</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>createWeapon</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>

    <!-- WeaponModelEndpoint -->
    <security-role-mapping>
        <role-name>getAllActiveWeaponModels</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getAllActiveWeaponModelsWithActiveWeapons</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getWeaponModel</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>addWeaponModel</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>editWeaponModel</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>

    <!-- WeaponModelCategoryEndpoint -->
    <security-role-mapping>
        <role-name>getAllWeaponCategories</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>

    <security-role-mapping>
        <role-name>removeWeaponModel</role-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <!-- OpinionEndpoint -->
    <security-role-mapping>
        <role-name>getAllOpinionsForWeaponModel</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
        <group-name>ROLE_EMPLOYEE</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>addOpinion</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>editOpinion</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>removeOpinion</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <security-role-mapping>
        <role-name>getOwnOpinionForWeaponModel</role-name>
        <group-name>ROLE_CUSTOMER</group-name>
    </security-role-mapping>
    <class-loader delegate="true"/>
</glassfish-web-app>
